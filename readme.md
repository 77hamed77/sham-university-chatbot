تمام\! لقد جمعت الآن كل الأجزاء الأساسية لمشروعك. بناءً على هيكل الملفات، وأكواد `app.py` و `chatbot.py` و `build_vector_db.py` و `clean_data.py` و `scrape_sham_university.py` و `scrape_with_ocr.py`، بالإضافة إلى ملف `config.toml` ومتغيرات `.env`، سأقوم بإنشاء ملف `README.md` احترافي يشرح المشروع من البداية إلى النهاية.

-----

# 🎓 شات بوت جامعة الشام: مساعدك الذكي

*(مثال: هنا يمكن وضع شعار أو لقطة شاشة للشات بوت إذا كانت متوفرة في مجلد `images`)*

يهدف هذا المشروع إلى بناء شات بوت ذكي لجامعة الشام، يوفر للطلاب والمستخدمين معلومات دقيقة وسريعة حول الجامعة، كلياتها، أقسامها، شروط القبول، والمزيد. يجمع هذا الشات بوت بين تقنيات استرجاع المعلومات من قواعد بيانات مُعدة مسبقًا (FAQ) وقوة الذكاء الاصطناعي التوليدي (Google Gemini) لتقديم إجابات شاملة ودقيقة.

## 🌟 الميزات الرئيسية

  * **نظام إجابة هجين:**
      * **بحث سريع في الأسئلة الشائعة (FAQ):** يعطي الأولوية للإجابات المحددة مسبقًا من قاعدة بيانات الأسئلة الشائعة لتقديم استجابات فورية ودقيقة للمعلومات المتكررة.
      * **ذكاء اصطناعي توليدي (Google Gemini):** في حال عدم وجود تطابق مباشر في الـ FAQ، يتم اللجوء إلى نموذج Google Gemini (`gemini-1.5-flash`) لتوليد إجابات بناءً على فهمه العام ولتوفير معلومات إضافية.
  * **استرجاع معزز (RAG - Retrieval Augmented Generation):** يستخدم قواعد بيانات المتجهات (Vector Databases) المبنية باستخدام FAISS ونماذج التضمين (Embeddings) للبحث الدلالي عن المعلومات ذات الصلة.
  * **جمع بيانات شامل:**
      * **زحف الويب (Web Scraping):** يقوم بجمع النصوص من صفحات الويب الخاصة بالجامعة.
      * **التعرف الضوئي على الأحرف (OCR):** يستخلص النصوص حتى من الصور الموجودة على موقع الجامعة لضمان عدم تفويت أي معلومات هامة.
  * **معالجة وتنظيف البيانات:** يتضمن سكريبتات متخصصة لتنظيف وتجهيز النصوص المجمعة، وإزالة المعلومات غير المفيدة والضوضاء.
  * **واجهة مستخدم تفاعلية وجذابة:** مبني باستخدام Streamlit، مع تصميم مخصص وألوان مميزة لتجربة مستخدم سلسة وممتعة.
  * **سجل المحادثات:** يحفظ سجل المحادثات بشكل دائم في ملف `chat_history.json`، مما يسمح للمستخدمين بمراجعة محادثاتهم السابقة.
  * **خيارات إدارة المحادثة:** يوفر أزرارًا لـ "بدء محادثة جديدة" و "مسح جميع المحادثات (دائم)" و "عرض سجل المحادثات".

## ⚙️ هيكل المشروع

يتكون المشروع من المجلدات والملفات الرئيسية التالية:

```
CHATBOT_SHAM/
├── .streamlit/
│   └── config.toml           # إعدادات ثيم Streamlit المخصص.
├── faiss_university_db/      # قاعدة بيانات المتجهات العامة للفقرات (غير مستخدمة حالياً في app.py).
│   ├── index.faiss
│   └── index.pkl
├── faiss_university_qa_db/   # قاعدة بيانات المتجهات للأسئلة الشائعة (FAQ).
│   ├── index.faiss
│   └── index.pkl
├── images/                   # مجلد لتخزين الشعارات والصور المستخدمة في الواجهة.
│   ├── logo-opacity.png
│   └── ...
├── .env                      # ملف لتخزين المتغيرات البيئية الحساسة (مثل مفتاح Google API).
├── all_university_paragraphs.txt # ملف نصي خام يحتوي على جميع الفقرات المجمعة من الويب.
├── app.py                    # الملف الرئيسي لتطبيق Streamlit، يمثل واجهة الشات بوت.
├── build_vector_db.py        # سكريبت لبناء قواعد بيانات المتجهات (FAISS) من نصوص الـ FAQ.
├── chat_history.json         # ملف JSON لتخزين سجل المحادثات بشكل دائم.
├── chatbot.py                # منطق الشات بوت الأساسي (نسخة أبسط للاختبار عبر سطر الأوامر).
├── clean_data.py             # سكريبت لتنظيف البيانات النصية الخام.
├── cleaned_university_paragraphs.txt # ملف نصي يحتوي على الفقرات النظيفة بعد المعالجة.
├── scrape_sham_university.py # سكريبت لزحف الويب وجمع النصوص من HTML.
├── scrape_with_ocr.py        # سكريبت لزحف الويب واستخلاص النصوص من HTML والصور (باستخدام OCR).
├── university_faq_qa.txt     # ملف نصي يحتوي على أزواج الأسئلة والأجوبة (FAQ).
├── university_texts_with_ocr.txt # ملف نصي يحتوي على جميع النصوص المجمعة (HTML + OCR).
└── README.md                 # هذا الملف.
```

## 🚀 دليل البدء السريع

لإعداد وتشغيل شات بوت جامعة الشام على جهازك، اتبع الخطوات التالية:

### 1\. المتطلبات الأساسية

تأكد من تثبيت البرامج التالية:

  * **Python 3.9+:** يوصى باستخدام أحدث إصدار مستقر من Python.
  * **pip:** مدير حزم Python (يأتي عادةً مع Python).
  * **Tesseract OCR:** يجب تثبيت Tesseract OCR على نظامك.
      * **Windows:** يمكنك تنزيل المثبت من [Tesseract-OCR GitHub](https://www.google.com/search?q=https://github.com/UB-Mannheim/tesseract/wiki).
      * **macOS:** `brew install tesseract`
      * **Linux (Ubuntu/Debian):** `sudo apt install tesseract-ocr`
      * **هام:** بعد التثبيت، قد تحتاج إلى تحديد مسار `tesseract.exe` في الكود إذا لم يتم اكتشافه تلقائيًا. (انظر `scrape_with_ocr.py` للتعليمات).

### 2\. إعداد البيئة

1.  **استنساخ المستودع (أو تنزيل الملفات):**
    إذا كان المشروع على GitHub، استخدم:

    ```bash
    git clone <رابط_مستودع_المشروع>
    cd CHATBOT_SHAM
    ```

    وإلا، قم بتنزيل جميع الملفات وفك ضغطها في مجلد باسم `CHATBOT_SHAM`.

2.  **إنشاء بيئة افتراضية (موصى به):**

    ```bash
    python -m venv venv
    ```

3.  **تفعيل البيئة الافتراضية:**

      * **Windows:**
        ```bash
        .\venv\Scripts\activate
        ```
      * **macOS / Linux:**
        ```bash
        source venv/bin/activate
        ```

4.  **تثبيت المكتبات المطلوبة:**

    ```bash
    pip install -r requirements.txt
    ```

    **(ملاحظة:** إذا لم يكن لديك ملف `requirements.txt`، ستحتاج إلى إنشاء واحد يحتوي على المكتبات التالية: `streamlit`, `langchain-community`, `langchain-google-genai`, `langchain-core`, `sentence-transformers`, `python-dotenv`, `requests`, `beautifulsoup4`, `pytesseract`, `Pillow`, `faiss-cpu`.)
    مثال على `requirements.txt`:

    ```
    streamlit
    langchain-community
    langchain-google-genai
    langchain-core
    sentence-transformers
    python-dotenv
    requests
    beautifulsoup4
    pytesseract
    Pillow
    faiss-cpu
    ```

5.  **إعداد مفتاح Google API:**

      * احصل على مفتاح Google API من [Google Cloud Console](https://console.cloud.google.com/apis/credentials).
      * أنشئ ملفًا جديدًا باسم `.env` في المجلد الرئيسي للمشروع (`CHATBOT_SHAM/`).
      * أضف السطر التالي إلى ملف `.env` (مع استبدال `YOUR_API_KEY_HERE` بمفتاحك الفعلي):
        ```
        GOOGLE_API_KEY="YOUR_API_KEY_HERE"
        ```
      * **تنبيه أمني:** لا تقم أبدًا برفع ملف `.env` الذي يحتوي على مفتاحك الخاص إلى مستودع عام (مثل GitHub)\!

### 3\. إعداد قواعد البيانات والمعرفة

قبل تشغيل الشات بوت، يجب عليك بناء قواعد بيانات المتجهات.

1.  **جمع البيانات الأولية (Scraping):**
    ابدأ بجمع النصوص من موقع الجامعة. يمكنك استخدام أحد السكريبتين التاليين:

      * **لجمع النصوص من HTML فقط:**
        ```bash
        python scrape_sham_university.py
        ```
        سينتج هذا الملف `all_university_paragraphs.txt`.
      * **لجمع النصوص من HTML والصور (باستخدام OCR):**
        ```bash
        python scrape_with_ocr.py
        ```
        **تنبيه:** تأكد من أن Tesseract OCR مثبت بشكل صحيح ومساره محدد في `scrape_with_ocr.py` قبل التشغيل.
        سينتج هذا الملف `university_texts_with_ocr.txt`. (يمكنك استخدام هذا الملف بدلاً من `all_university_paragraphs.txt` إذا كنت تريد تضمين نصوص OCR في قاعدة بياناتك العامة).

2.  **تنظيف البيانات:**
    بعد جمع البيانات، قم بتنظيفها:

    ```bash
    python clean_data.py
    ```

    سينتج هذا الملف `cleaned_university_paragraphs.txt` الذي يحتوي على الفقرات المنظفة والفريدة.

3.  **إعداد ملف الأسئلة الشائعة (FAQ):**
    يجب أن يكون لديك ملف `university_faq_qa.txt` في المجلد الرئيسي للمشروع. هذا الملف يجب أن يحتوي على أزواج من الأسئلة والأجوبة بهذا التنسيق:

    ```
    س: ما هي الكليات المتاحة في جامعة الشام؟
    ج: جامعة الشام تقدم كليات مثل العلوم الصحية، الاقتصاد والإدارة، الهندسة، التربية، الشريعة والقانون، والعلوم السياسية.
    ---
    س: أين تقع جامعة الشام؟
    ج: جامعة الشام تقع في دمشق، سوريا.
    ---
    # المزيد من الأسئلة والأجوبة
    ```

    يمكنك إنشاء هذا الملف يدويًا أو جمعه من مصادر موثوقة.

4.  **بناء قاعدة بيانات المتجهات للأسئلة الشائعة (FAQ Vector DB):**
    هذا السكريبت سيأخذ ملف `university_faq_qa.txt` ويقوم بتحويل الأسئلة إلى متجهات ثم يخزنها في قاعدة بيانات FAISS.

    ```bash
    python build_vector_db.py
    ```

    سينتج هذا الملف مجلد `faiss_university_qa_db/` الذي يحتوي على ملفات الفهرسة (`index.faiss` و `index.pkl`).

### 4\. تشغيل الشات بوت

بمجرد إعداد كل شيء، يمكنك تشغيل تطبيق الشات بوت:

```bash
streamlit run app.py
```

سيقوم هذا الأمر بفتح تطبيق الشات بوت في متصفح الويب الافتراضي الخاص بك (عادةً على `http://localhost:8501`).

### 5\. التفاعل مع الشات بوت

  * ستظهر واجهة الشات بوت في المتصفح.
  * سترى رسالة ترحيبية من الشات بوت.
  * يمكنك البدء في طرح الأسئلة في مربع الإدخال في الأسفل.
  * سيعرض الشات بوت الإجابات، مع إشارة إلى ما إذا كانت الإجابة من قاعدة بيانات الأسئلة الشائعة (FAQ) أو من الذكاء الاصطناعي التوليدي (Google Gemini).
  * يمكنك استخدام الأزرار في الشريط الجانبي لـ "بدء محادثة جديدة" أو "مسح جميع المحادثات (دائم)" أو "عرض سجل المحادثات".

## 🛠️ كيفية العمل (نظرة فنية)

يعتمد هذا الشات بوت على بنية تعتمد على **الاسترجاع المعزز للتوليد (RAG)** لتقديم إجابات دقيقة وذات صلة:

1.  **جمع البيانات (`scrape_sham_university.py`, `scrape_with_ocr.py`):**

      * يتم استخدام مكتبتي `requests` و `BeautifulSoup` لزحف صفحات الويب وجمع الفقرات النصية من وسم `<p>`.
      * يستخدم `scrape_with_ocr.py` إضافة `pytesseract` (واجهة Tesseract OCR) و `Pillow` لاستخلاص النصوص من الصور الموجودة على صفحات الويب، مما يوسع نطاق جمع المعلومات.
      * يتم حفظ النصوص المجمعة في ملفات `.txt` (مثل `all_university_paragraphs.txt` أو `university_texts_with_ocr.txt`).

2.  **تنظيف البيانات (`clean_data.py`):**

      * يتم تطبيق سلسلة من عمليات التنظيف على النصوص المجمعة لإزالة المسافات الزائدة، العبارات غير المفيدة (مثل حقوق النشر أو "المزيد")، والأرقام والرموز غير الأبجدية.
      * يتم ضمان تفرد الفقرات لمنع التكرار في قاعدة المعرفة.
      * يتم حفظ النصوص النظيفة في `cleaned_university_paragraphs.txt`.

3.  **بناء قواعد بيانات المتجهات (`build_vector_db.py`):**

      * **الأسئلة الشائعة (FAQ):** يتم قراءة أزواج الأسئلة والأجوبة من `university_faq_qa.txt`. يتم تحويل كل سؤال إلى "مستند" (Document) وتخزين الإجابة المرتبطة به في `metadata` الخاص بالمستند.
      * **نماذج التضمين (Embeddings):** يتم استخدام `HuggingFaceEmbeddings` مع النموذج `sentence-transformers/distiluse-base-multilingual-cased-v1` لتحويل النصوص (الأسئلة) إلى متجهات رقمية (embeddings) تمثل معناها الدلالي.
      * **FAISS:** يتم استخدام مكتبة FAISS لإنشاء قاعدة بيانات متجهات قابلة للبحث بكفاءة من هذه التضمينات. يتم حفظ قاعدة بيانات الـ FAQ في `faiss_university_qa_db/`. (يلاحظ أن `faiss_university_db` موجودة في الهيكل ولكن `app.py` يركز حالياً على `faiss_university_qa_db`).

4.  **منطق الشات بوت (`app.py`، `chatbot.py`):**

      * **`app.py` (واجهة Streamlit):**
          * يقوم بتحميل قاعدة بيانات `faiss_university_qa_db` ونموذج Google Gemini LLM.
          * عند استلام سؤال من المستخدم، يقوم أولاً بالبحث في قاعدة بيانات الـ FAQ عن أقرب سؤال مطابق باستخدام FAISS ودرجة التشابه.
          * إذا كانت درجة التشابه عالية (أقل من `FAQ_DISTANCE_THRESHOLD`)، يتم استرجاع الإجابة من `metadata` السؤال المطابق في الـ FAQ.
          * إذا لم يتم العثور على تطابق واثق في الـ FAQ، يتم توجيه السؤال إلى نموذج Google Gemini LLM لتوليد إجابة عامة.
          * يتم عرض الإجابة للمستخدم مع تحديد مصدرها (FAQ أو LLM).
          * يتم حفظ سجل المحادثات في `chat_history.json`.
      * **`chatbot.py` (نسخة CLI للاختبار):** يوفر وظائف أساسية لتحميل قاعدة بيانات الـ FAQ واختبار الاسترجاع عبر سطر الأوامر دون واجهة Streamlit.

5.  **الواجهة الأمامية (`app.py` و `.streamlit/config.toml`):**

      * يتم استخدام Streamlit لإنشاء واجهة مستخدم ويب سريعة وسهلة.
      * يحدد `config.toml` الألوان الأساسية للثيم.
      * يحتوي `app.py` على أكواد CSS مخصصة لتصميم فقاعات الدردشة، الشريط الجانبي، الأزرار، والخلفية المتدرجة، مما يمنح التطبيق مظهرًا احترافيًا.

## 🤝 المساهمة

نرحب بالمساهمات لتحسين هذا المشروع. إذا كنت ترغب في المساهمة، يرجى:

1.  عمل `Fork` للمستودع.
2.  إنشاء فرع جديد (`git checkout -b feature/YourFeature`).
3.  قم بإجراء تغييراتك وقم بالالتزام بها (`git commit -m 'Add some feature'`).
4.  ادفع إلى الفرع (`git push origin feature/YourFeature`).
5.  افتح طلب دمج (Pull Request).

## 📄 الترخيص

هذا المشروع مرخص بموجب ترخيص [أدخل نوع الترخيص هنا، مثال: MIT License].

-----

**ملاحظة هامة:** هذا الشات بوت يجيب بناءً على معلومات تم جمعها وتجهيزها مسبقاً من موقع الجامعة، بالإضافة إلى قدرات الذكاء الاصطناعي التوليدي. للحصول على أحدث المعلومات أو في حالات الطوارئ، يرجى زيارة الموقع الرسمي أو التواصل المباشر مع الجامعة.

© 2025 شات بوت جامعة الشام. جميع الحقوق محفوظة.

-----
